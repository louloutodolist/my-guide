<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Loulou's To Do List</title>
  <style>
    :root {
      --bg: #f7f7f8;
      --card: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --brand: #2563eb;
      --brand-2: #1d4ed8;
      --ok: #16a34a;
      --danger: #ef4444;
      --ring: 0 0 0 3px rgba(37,99,235,.25);
    }
    * { box-sizing: border-box; }
    html, body { margin:0; padding:0; background:var(--bg); color:var(--text); font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; }
    header { padding:24px 16px 8px; font-size:22px; font-weight:800; }
    .wrap { padding: 8px 16px 40px; }
    .card { background:var(--card); border-radius:16px; box-shadow: 0 6px 22px rgba(0,0,0,.06); padding:14px; }
    .row { display:flex; gap:8px; }
    input[type="text"] {
      flex:1; padding:14px 12px; border-radius:12px; border:1px solid #e5e7eb; background:#fff; font-size:16px;
    }
    input[type="text"]:focus { outline:none; box-shadow: var(--ring); border-color: var(--brand); }
    button {
      border:0; border-radius:12px; padding:12px 16px; font-weight:700; background:var(--brand); color:#fff;
    }
    button:active { transform: translateY(1px); }
    button.secondary { background:#e5e7eb; color:#111; }
    ul { list-style:none; padding:0; margin:12px 0 0; }
    li {
      display:flex; align-items:center; gap:10px; padding:12px; border:1px solid #eef0f3; border-radius:12px; margin-top:8px; background:#fff;
    }
    li.done .txt { text-decoration: line-through; color: var(--muted); }
    .txt { flex:1; word-break: break-word; }
    .meta { font-size:12px; color:var(--muted); margin-top:2px; }
    .icon-btn {
      background:#f3f4f6; border-radius:10px; border:0; width:38px; height:38px; display:grid; place-items:center;
    }
    .danger { background:#fee2e2; color:#991b1b; }
    .filters { display:flex; gap:8px; margin-top:10px; }
    .pill {
      padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid #e5e7eb; background:#fff; color:#111;
    }
    .pill.active { border-color: var(--brand); color:#0b3fd6; }
    .footer { margin-top:12px; font-size:12px; color:var(--muted); }
  </style>
</head>
<body>
  <header>My To-Do (Offline)</header>

  <div class="wrap">
    <div class="card">
      <div class="row">
        <input id="newTask" type="text" placeholder="Add a task…" autocomplete="off" />
        <button id="addBtn">Add</button>
      </div>

      <div class="filters" id="filters">
        <button class="pill active" data-filter="all">All</button>
        <button class="pill" data-filter="open">Open</button>
        <button class="pill" data-filter="done">Done</button>
        <button class="pill secondary" id="clearDone">Clear Done</button>
      </div>

      <ul id="list"></ul>
      <div class="footer" id="count"></div>
    </div>
  </div>

  <script>
    const KEY = "todos.v2";
    let todos = load();
    let filter = "all";

    const $ = sel => document.querySelector(sel);
    const listEl = $("#list");
    const input = $("#newTask");
    const addBtn = $("#addBtn");
    const countEl = $("#count");

    function load() {
      try { return JSON.parse(localStorage.getItem(KEY)) || []; }
      catch { return []; }
    }
    function save() { localStorage.setItem(KEY, JSON.stringify(todos)); }

    function uid(){ return Math.random().toString(36).slice(2,9); }

    function render() {
      listEl.innerHTML = "";
      let items = todos;
      if (filter === "open") items = items.filter(t=>!t.done);
      if (filter === "done") items = items.filter(t=>t.done);

      for (const t of items) {
        const li = document.createElement("li");
        if (t.done) li.classList.add("done");

        const cb = document.createElement("input");
        cb.type = "checkbox"; cb.checked = t.done;
        cb.addEventListener("change", ()=> { t.done = !t.done; save(); render(); });

        const textWrap = document.createElement("div");
        const txt = document.createElement("div");
        txt.className = "txt";
        txt.textContent = t.text;
        const meta = document.createElement("div");
        meta.className = "meta";
        meta.textContent = new Date(t.created).toLocaleString();
        textWrap.appendChild(txt); textWrap.appendChild(meta);

        const del = document.createElement("button");
        del.className = "icon-btn danger";
        del.title = "Delete";
        del.textContent = "✕";
        del.addEventListener("click", ()=> { 
          todos = todos.filter(x=>x.id!==t.id); save(); render();
        });

        li.appendChild(cb);
        li.appendChild(textWrap);
        li.appendChild(del);
        listEl.appendChild(li);
      }
      const openCount = todos.filter(t=>!t.done).length;
      countEl.textContent = `${openCount} open • ${todos.length} total`;
      // update filter UI
      document.querySelectorAll(".pill").forEach(p=>{
        p.classList.toggle("active", p.dataset.filter===filter);
      });
    }

    function addTask() {
      const v = input.value.trim();
      if (!v) return;
      todos.unshift({ id: uid(), text: v, done:false, created: Date.now() });
      input.value = "";
      save(); render();
    }

    addBtn.addEventListener("click", addTask);
    input.addEventListener("keydown", e=>{ if(e.key==="Enter") addTask(); });

    $("#filters").addEventListener("click", (e)=>{
      const f = e.target?.dataset?.filter;
      if (f) { filter = f; render(); }
    });
    $("#clearDone").addEventListener("click", ()=>{
      todos = todos.filter(t=>!t.done); save(); render();
    });

    render();
  </script>
</body>
</html>

